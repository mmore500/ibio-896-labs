(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12869,        360]
NotebookOptionsPosition[     10378,        309]
NotebookOutlinePosition[     10838,        327]
CellTagsIndexPosition[     10795,        324]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "EcoEvo`"}]], "Input",
 CellChangeTimes->{{3.7450596450417423`*^9, 3.7450596474004602`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d79b8cfb-f9fb-41e2-978a-dae95b0a9291"],

Cell[CellGroupData[{

Cell["Logistic equation", "Section",
 CellChangeTimes->{
  3.3979526211858892`*^9, {3.397989611608563*^9, 3.3979896120002832`*^9}, {
   3.398598437056386*^9, 3.398598439639843*^9}, 3.556435998833042*^9, 
   3.5564371451262693`*^9, 
   3.713555167676515*^9},ExpressionUUID->"b9c06025-e6ee-4860-a7b8-\
2facb623d3c4"],

Cell["\<\
Here we will explore the logistic equation dn/dt=rn(1-n/k)=f(n)\
\>", "Text",
 CellChangeTimes->{{3.39859844542492*^9, 3.398598459954687*^9}, {
   3.3985991582956657`*^9, 3.3985991605546837`*^9}, {3.5564371478665943`*^9, 
   3.556437148779509*^9}, 
   3.713555091203782*^9},ExpressionUUID->"8fec9229-ddbb-4a15-9c7f-\
45781bc09cd0"],

Cell[BoxData[
 RowBox[{"SetModel", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Pop", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Variable", "\[Rule]", "n"}], ",", 
      RowBox[{"Equation", "\[RuleDelayed]", 
       RowBox[{"f", "[", 
        RowBox[{"n", "[", "t", "]"}], "]"}]}]}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.713554225091771*^9, 3.713554257376877*^9}, {
  3.713554412930539*^9, 3.713554413075461*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a0ed044d-75eb-46dc-ab12-4e5bf5f44af0"],

Cell[CellGroupData[{

Cell["Plot dn/dt vs n.", "Subsection",
 CellChangeTimes->{{3.398599140370644*^9, 
  3.398599154886559*^9}},ExpressionUUID->"bbdb902e-9c9a-4c6b-bba4-\
fb9af6e467a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "1.0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "n_", "]"}], ":=", 
    RowBox[{"r", "*", "n", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"n", "/", "k"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "n", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "1.1"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<n\>\"", ",", "\"\<dn/dt\>\""}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.398599136412129*^9, 3.398599189642604*^9}, {
  3.619303887839884*^9, 3.6193038880696697`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"dd7733ec-8c3f-49e8-8c55-21dc49f31fb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve the model numerically for different initial conditions.\
\>", "Subsection",
 CellChangeTimes->{{3.398598545799327*^9, 3.398598557367104*^9}, {
  3.398599031714572*^9, 
  3.398599033391274*^9}},ExpressionUUID->"a04257d5-4c88-435d-b9da-\
625b2e4fb492"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"EcoSim", "[", 
    RowBox[{
     StyleBox[
      RowBox[{"{", 
       RowBox[{"n", "\[Rule]", "0.1"}], "}"}],
      Background->RGBColor[1, 1, 0]], ",", "tmax"}], "]"}]}], ";"}], "\n", 
 RowBox[{"PlotDynamics", "[", "sol", "]"}]}], "Input",
 CellChangeTimes->{{3.713554356055007*^9, 3.713554380586913*^9}, {
   3.713554461431788*^9, 3.7135544645946712`*^9}, {3.713555026322446*^9, 
   3.713555028932785*^9}, {3.7135551186277933`*^9, 3.7135551187040787`*^9}, 
   3.745074098328723*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"4293bf93-a5e4-4023-8da7-348ead05d299"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Allee effects", "Section",
 CellChangeTimes->{{3.398598475078972*^9, 3.3985984788397093`*^9}, {
   3.4620890569902*^9, 3.462089072950747*^9}, 3.5564058063574057`*^9, 
   3.71355517272462*^9},ExpressionUUID->"9f4cf1ff-9b75-4600-8ab2-\
a7cf984424cc"],

Cell["\<\
Now do the same for a model with an Allee effect: dn/dt=r*(n-a)*(k-n)*n, \
0<a<k, r>0\
\>", "Text",
 CellChangeTimes->{{3.39859844542492*^9, 3.398598459954687*^9}, {
  3.3985991582956657`*^9, 3.3985991605546837`*^9}, {3.398599258480267*^9, 
  3.398599284599799*^9}, {3.398609651231626*^9, 3.3986096514688787`*^9}, {
  3.619955486888242*^9, 3.6199554886160593`*^9}}],

Cell[CellGroupData[{

Cell["Plot dn/dt vs n.", "Subsection",
 CellChangeTimes->{{3.398599140370644*^9, 3.398599154886559*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "n_", "]"}], ":=", 
    RowBox[{"r", "*", "n", "*", 
     RowBox[{"(", 
      RowBox[{"k", "-", "n"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"n", "-", "a"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "n", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "1.1"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<n\>\"", ",", "\"\<dn/dt\>\""}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.398599136412129*^9, 3.398599189642604*^9}, {
  3.619303887839884*^9, 3.6193038880696697`*^9}, {3.619955105177285*^9, 
  3.619955124880785*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"3b96e2bf-6001-47aa-8be4-7d02b4723e1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve the model numerically for different initial conditions.  Can you show \
multiple stable equilibria?\
\>", "Subsection",
 CellChangeTimes->{{3.398598545799327*^9, 3.398598557367104*^9}, {
  3.398599031714572*^9, 3.398599033391274*^9}, {3.713555130161551*^9, 
  3.713555138663087*^9}},ExpressionUUID->"cb24a27a-87d5-409a-9e5e-\
3f0f831f1f62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"EcoSim", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "\[Rule]", "0.01"}], "}"}], ",", "tmax"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"PlotDynamics", "[", "sol", "]"}]}], "Input",
 CellChangeTimes->{{3.398598559017179*^9, 3.398598632276577*^9}, {
   3.398598701769248*^9, 3.3985987223010263`*^9}, 3.3985991338640413`*^9, {
   3.398599194786356*^9, 3.398599195216749*^9}, {3.619303881817175*^9, 
   3.6193038924975567`*^9}, {3.619955271620308*^9, 3.619955308378059*^9}, 
   3.713554549084279*^9, {3.7135550197459297`*^9, 3.713555022042899*^9}, {
   3.713555125228195*^9, 3.713555125298685*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"af72ffd5-f1bc-4e52-91f7-41972ce1dd6b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discrete-Time Logistic", "Section",
 CellChangeTimes->{
  3.3979526211858892`*^9, {3.397989611608563*^9, 3.3979896120002832`*^9}, {
   3.5564058078927097`*^9, 3.556405810587365*^9}, {3.713555176970533*^9, 
   3.713555183129052*^9}},ExpressionUUID->"f778c3c4-3d07-4591-98a5-\
ae9c9833828c"],

Cell["\<\
Here we will explore the discrete logistic equation discussed in class and in \
May (1974): n[t+1]=n[t]exp[r*(1-n[t]/k)].\
\>", "Text",
 CellChangeTimes->{{3.651305124693247*^9, 3.651305125650388*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetModel", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Pop", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Variable", "\[Rule]", "n"}], ",", 
         RowBox[{"Equation", "\[RuleDelayed]", 
          RowBox[{"f", "[", 
           RowBox[{"n", "[", "t", "]"}], "]"}]}]}], "}"}]}], ",", 
      RowBox[{"ModelType", "\[Rule]", "\"\<DiscreteTime\>\""}]}], "}"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "n_", "]"}], ":=", 
   RowBox[{"n", "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"r", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"n", "/", "k"}]}], ")"}]}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.713554697151149*^9, 3.713554707066676*^9}, {
  3.71355475256318*^9, 3.713554752872362*^9}, {3.713554851514462*^9, 
  3.713554852740882*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f61c2a41-1c6c-428e-8f49-23081780e4da"],

Cell[CellGroupData[{

Cell["\<\
Simulate the difference equation for different values of r \
(r=0.5,1.2,1.8,2.2,2.6,3.0)
What happens?\
\>", "Subsubsection",
 CellChangeTimes->{{3.65131416369267*^9, 3.651314168345972*^9}, {
  3.713554897482376*^9, 
  3.7135549936847973`*^9}},ExpressionUUID->"d64916a5-dea3-46ba-bd0d-\
979c4e3ee687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "parameters"}], " ", "*)"}], "\n", 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"r", "=", "0.5"}], ";"}],
    Background->RGBColor[1, 1, 0]], "\n", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"EcoSim", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "\[Rule]", "0.1"}], "}"}], ",", "tmax"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"PlotDynamics", "[", "sol", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7135547186984*^9, 3.7135547328644238`*^9}, {
  3.713554766573679*^9, 3.7135548114126787`*^9}, {3.71355486441529*^9, 
  3.713555001663659*^9}, {3.713555303729856*^9, 3.713555304736863*^9}, {
  3.745059725040811*^9, 3.7450597323444633`*^9}, {3.745151419836177*^9, 
  3.745151420406309*^9}},ExpressionUUID->"a1c6a63f-3f7b-468f-b069-\
da48cace1702"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.713555334372439*^9},ExpressionUUID->"eff65ff1-90dd-47cb-a021-\
73662787673c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 941},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>2. Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 3, 59, "Input",ExpressionUUID->"d79b8cfb-f9fb-41e2-978a-dae95b0a9291"],
Cell[CellGroupData[{
Cell[782, 27, 314, 6, 134, "Section",ExpressionUUID->"b9c06025-e6ee-4860-a7b8-2facb623d3c4"],
Cell[1099, 35, 341, 7, 69, "Text",ExpressionUUID->"8fec9229-ddbb-4a15-9c7f-45781bc09cd0"],
Cell[1443, 44, 547, 14, 59, "Input",ExpressionUUID->"a0ed044d-75eb-46dc-ab12-4e5bf5f44af0"],
Cell[CellGroupData[{
Cell[2015, 62, 164, 3, 107, "Subsection",ExpressionUUID->"bbdb902e-9c9a-4c6b-bba4-fb9af6e467a1"],
Cell[2182, 67, 924, 27, 265, "Input",ExpressionUUID->"dd7733ec-8c3f-49e8-8c55-21dc49f31fb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3143, 99, 266, 6, 107, "Subsection",ExpressionUUID->"a04257d5-4c88-435d-b9da-625b2e4fb492"],
Cell[3412, 107, 695, 16, 142, "Input",ExpressionUUID->"4293bf93-a5e4-4023-8da7-348ead05d299"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4156, 129, 254, 4, 134, "Section",ExpressionUUID->"9f4cf1ff-9b75-4600-8ab2-a7cf984424cc"],
Cell[4413, 135, 375, 7, 69, "Text",ExpressionUUID->"0636ad88-ff93-4053-8b4a-e0d594c9f21a"],
Cell[CellGroupData[{
Cell[4813, 146, 104, 1, 107, "Subsection",ExpressionUUID->"cd02c2c6-74e9-41fa-8f65-8735878f27da"],
Cell[4920, 149, 1079, 31, 306, "Input",ExpressionUUID->"3b96e2bf-6001-47aa-8be4-7d02b4723e1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6036, 185, 356, 7, 160, "Subsection",ExpressionUUID->"cb24a27a-87d5-409a-9e5e-3f0f831f1f62"],
Cell[6395, 194, 814, 17, 142, "Input",ExpressionUUID->"af72ffd5-f1bc-4e52-91f7-41972ce1dd6b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7258, 217, 295, 5, 134, "Section",ExpressionUUID->"f778c3c4-3d07-4591-98a5-ae9c9833828c"],
Cell[7556, 224, 211, 4, 69, "Text",ExpressionUUID->"2ce2090a-c0d4-456e-be8b-dc3c7195e348"],
Cell[7770, 230, 1055, 29, 142, "Input",ExpressionUUID->"f61c2a41-1c6c-428e-8f49-23081780e4da"],
Cell[CellGroupData[{
Cell[8850, 263, 311, 8, 140, "Subsubsection",ExpressionUUID->"d64916a5-dea3-46ba-bd0d-979c4e3ee687"],
Cell[9164, 273, 1036, 27, 306, "Input",ExpressionUUID->"a1c6a63f-3f7b-468f-b069-da48cace1702"],
Cell[10203, 302, 147, 3, 101, "Input",ExpressionUUID->"eff65ff1-90dd-47cb-a021-73662787673c"]
}, Open  ]]
}, Open  ]]
}
]
*)

